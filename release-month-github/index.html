<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Release Month Finder | あなたとともに生まれた時計が見つかる！</title>
  <meta name="description" content="発売“月”で腕時計を検索できるミニDB。あなたと同じ月に生まれた時計を探せる。">
  <link rel="icon" href="./assets/img/favicon.svg">
  <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>
<header class="topbar">
  <div class="wrap">
    <div class="brand">
      <img src="./assets/img/logo.svg" alt="" width="24" height="24">
      <span>Release Month Finder</span>
    </div>
    <nav class="nav">
      <a href="#search">検索</a>
      <a href="#about">このサイト</a>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="wrap hero-inner">
    <div class="hero-copy">
      <h1>あなたとともに生まれた時計が見つかる！</h1>
      <p>発売<em>“月”</em>で横断検索。一次資料の出典と確度ラベルつき。</p>
    </div>
    <div class="hero-art"><img src="./assets/img/hero.svg" alt=""></div>
  </div>
</section>

<main class="wrap">
  <section id="search" class="panel search">
    <div class="field"><label>ブランド</label><input id="brand" placeholder="SEIKO / ROLEX / OMEGA…"></div>
    <div class="field"><label>年</label><input id="year" type="number" placeholder="2001" min="1900" max="2100"></div>
    <div class="field"><label>月</label>
      <select id="month">
        <option value="">（指定なし）</option>
        <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option>
      </select>
    </div>
    <div class="actions">
      <button id="go">検索</button>
      <button id="reset" class="ghost">リセット</button>
    </div>
  </section>

  <section id="results" class="grid">
    <div class="empty">検索するとここに結果が出ます。</div>
  </section>

  <section id="about" class="panel about">
    <h2>このサイトについて</h2>
    <p>発売月（確定）/ 発表月 / 不明 をラベルで区別し、出典リンクを必ず添えます。画像・ロゴは権利保護のため自作またはフリー素材のみ使用。</p>
  </section>
</main>

<footer class="foot"><div class="wrap"><small>© 2025 Release Month Finder</small></div></footer>

<script>
async function getData() { const r = await fetch('./data/releases.json'); return await r.json(); }
function badge(x) {
  const cls = x.status === '確定' ? 'badge solid' : (x.status === '発表月' ? 'badge outline' : 'badge ghost');
  const m = x.release_month ? (x.release_month + '月') : '—';
  return `<span class="${cls}">${m} / ${x.status||'不明'}</span>`;
}
function card(x) {
  const src = (x.sources||[]).map(s => `<li><a href="${s.url}" target="_blank" rel="noopener">${s.title||s.url}</a></li>`).join('');
  const img = x.image || './assets/img/card-placeholder.svg';
  return `<article class="card">
    <img class="thumb" src="${img}" alt="">
    <div class="body">
      <header><strong>${x.brand}</strong> <span class="muted">${x.reference||''}</span></header>
      <div class="title">${x.model||''}</div>
      <div class="meta">
        <div><b>年</b> ${x.release_year||'—'}</div>
        <div><b>月</b> ${x.release_month||'—'}</div>
        <div><b>確度</b> ${(x.confidence??0).toFixed(2)}</div>
        <div>${badge(x)}</div>
      </div>
      <details><summary>証拠</summary><ul>${src||'<li>—</li>'}</ul><p>${x.notes||''}</p></details>
    </div>
  </article>`;
}
function render(list) {
  const el = document.getElementById('results');
  if (!list.length) { el.innerHTML = '<div class="empty">該当レコードがありません。</div>'; return; }
  el.innerHTML = list.map(card).join('');
}
function applyFilter(data) {
  const b = document.getElementById('brand').value.trim().toLowerCase();
  const y = document.getElementById('year').value.trim();
  const m = document.getElementById('month').value;
  return data.filter(x =>
    (!b || (x.brand||'').toLowerCase().includes(b)) &&
    (!y || String(x.release_year)===String(y)) &&
    (!m || Number(x.release_month)===Number(m))
  );
}
(async () => {
  const data = await getData();
  document.getElementById('go').onclick = () => render(applyFilter(data));
  document.getElementById('reset').onclick = () => { document.getElementById('brand').value=''; document.getElementById('year').value=''; document.getElementById('month').value=''; render([]); };
})();
</script>
</body>
</html>
